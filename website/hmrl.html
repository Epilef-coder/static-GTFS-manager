<!DOCTYPE html>
<html lang="en">

<head>
	<!-- Required meta tags-->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<title>GTFS Manager : HRML Import</title>


	<!-- Fontfaces CSS-->
	<link href="css/font-face.css" rel="stylesheet" media="all">
	<link href="vendor/font-awesome-5/css/all.min.css" rel="stylesheet" media="all">

	<!-- Bootstrap CSS-->
	<link href="vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

	<!-- Leaflet Maps -->
	<link href="lib/leaflet.css" orig="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" rel="stylesheet" />
	<link href="lib/easy-button.css" alt="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css" rel="stylesheet" />
	<link href="lib/L.Control.ZoomBox.css" rel="stylesheet" />

	<!-- Vendor CSS-->
	<link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
	
	<link href="vendor/select2/css/select2.min.css" rel="stylesheet" media="all">
	<link href="vendor/select2/css/select2-bootstrap4.min.css" rel="stylesheet" media="all">
	<link href="vendor/toast-0.7.1/toast.min.css" rel="stylesheet" media="all">

	<link href="vendor/tabulator-4.4.3/css/bootstrap/tabulator_bootstrap4.min.css" rel="stylesheet" media="all">
	<script src="vendor/tabulator-4.4.3/js/tabulator.min.js"></script>

	<!-- Main CSS-->
	<link href="css/theme.css" rel="stylesheet" media="all">
	<!-- Put the CSSs first and JSs next -->
	<style>
		/* Tabulator tables: */
		#stops-table {
			height: 300px;
		}

		#missing-stops-table {
			height: 255px;
		}

		#replace-stops-table {
			height: 150px;
		}

		#fareIDs-table {
			height: 350px;
		}

		#translations-table {
			height: 280px;
		}

		/* Leaflet maps: */
		#map {		
			position: relative;	
			height: 400px;
			width: 100%;
		}

		#smallMap {			
			height: 300px;
			width: 350px;
			/*
	display: inline-block;
	position:absolute;
	top:45px;
	right:0;
	*/
			border: 1px black solid;

		}

		.routeCard {
			font-size: .9em;
			padding: 3px;
		}		
		
		/* left and right spans in same line. from https://stackoverflow.com/a/5067308/4355695 */
		/*.left { float:left }*/
		.right {
			float: right
		}

		/* override jquery's */

		.routeSequence>div>ol>li>a:hover {
			color: red;
			font-weight: bold;
		}

		red {
			color: red;
			font-weight: bold;
		}
	</style>
	<script src="config/settings.js" type="text/javascript"></script>
</head>

<body class="page-content--bgf7">
	<div class="page-wrapper">
		<!-- HEADER DESKTOP-->
		<!-- HEADER DESKTOP-->
		<header class="header-desktop3 d-none d-lg-block">
			<div class="section__content section__content--p35">
				<div class="header3-wrap">
					<div class="header__logo">
						<a href="#">
							<img src="extra_files/GTFS.png" width="52" height="170" alt="GTFS Manager" />
						</a>
					</div>
					<div class="header__navbar" id="navmenuinsert">
						<!-- menu will be inserted from menu.js.-->
					</div>
					<div class="form-inline my-2 my-md-0">
						<input id="password" class="form-control mr-sm-2" type="text" placeholder="pw for edits" style="width:200px;" id="password">
					</div>
				</div>
			</div>
		</header>
		<!-- END HEADER DESKTOP-->
		<!-- MAIN CONTENT-->
		<div class="page-content--bgf7">
			<div class="section__content section__content--p30">
				<div class="container-fluid">
					<div class="row">
						<div class="col-md-12">
							<div class="accordion" id="accordionExample">
								<div class="card">
									<div class="card-header" id="headingOne">
										<h2 class="mb-0">
											<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
												<i class="fas fa-angle-right"></i> Instructions
											</button>
										</h2>
									</div>
									<div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
										<div class="card-body">
											<h3>Instructions</h3>

											<p align="center"><a href="https://www.youtube.com/embed/MqEsAtcNieo?rel=0&autoplay=1" target="_blank"><img class="videothumb" src="hydcsv_related/hmrl-screenshot.png" height="240" width="auto"><br><small>Click here to see a demo
														video.</small></a></p>
											<p>This page handles the <a target="_blank" href="extra_files/sample-hyd-csv-input.txt">specific CSV
													format&#x2197;</a> of HMRL, Hyderabad, India. There are some files
												to upload and some settings to set before converting to GTFS. Please
												make your way through each of the tabs.</p>
											- Do remember to enter the password on top right for the final GTFS
											conversion.<br>
											- Detailed instructions are given in info boxes at each tab.
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header">
									<strong class="card-title mb-3">Convert CSV schedules format to GTFS (for Hyderabad
										Metro)</strong>
								</div>
								<div class="card-body">
									<ul class="nav nav-tabs" id="myTab" role="tablist">
										<li class="nav-item">
											<a class="nav-link active" id="LoadXML-tab" data-toggle="tab" href="#LoadXML" role="tab" aria-controls="LoadXML" aria-selected="true">1. Upload</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="Stations-tab" data-toggle="tab" href="#Stations" role="tab" aria-controls="Stations" aria-selected="false">2. Stops</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="Misc-tab" data-toggle="tab" href="#Misc" role="tab" aria-controls="Misc" aria-selected="false">3. Misc Info</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="Finally-tab" data-toggle="tab" href="#Finally" role="tab" aria-controls="Finally" aria-selected="false">4. Convert to
												GTFS</a>
										</li>
									</ul>
									<div class="tab-content" id="myTabContent">
										<div class="tab-pane fade show active" id="LoadXML" role="tabpanel" aria-labelledby="LoadXML-tab">
											<h3>1. Upload Files</h3>
											<p id="numRoutesLine">Choose number of Routes:
												<input id="numRoutesSelect" value="2" size="1">&nbsp;&nbsp;
												<button id="numRoutesButton">Set number</button>
												&nbsp; <small>warning: clicking this again will <span class="red">reset</span> everything below.</small>
											</p>
											<form id="form1" action="javascript:false;">

												<div class="row" id="routeUploadRepeater">
													<!-- this will get populated by upload fields depending on number of routes -->
												</div>

											</form>

											<div id="smallMap" class="smallMap"></div>
											<br><br>
											<p><a target="_blank" href="extra_files/sample-hyd-csv-input.txt">Click
													here&#x2197;</a> to see a sample structure of the HMRL CSV format.
											</p>


											<hr>
											<div class="alert alert-warning" id="CSVUploadStatus">
												Note: Be sure about which file is for weekdays and which for sunday.. as
												the files internally have no day information on them.<br><br>
											</div>
										</div>
										<div class="tab-pane fade" id="Stations" role="tabpanel" aria-labelledby="Stations-tab">
											<h3><a id="2"></a>2. Stops <small>(simplified)</small></h3>

											<div class="row">
												<div class="col-md-6">

													<div id="stops-table" class="table table-striped"></div>

													<br>
													<div class="row">
														<div class="col">
															<div class="form-group row">
																<label for="station2add" class="col-sm-5 col-form-label">Add a new station:</label>
																<div class="col-sm-5">
																	<input id="station2add" class="form-control" type="text">
																</div>
																<div class="col-sm-2">
																	<button class="btn btn-primary" id="addStation" type="button">Add</button>
																</div>
															</div>
															<small id="stationAddStatus"></small>
														</div>
														<div class="col">
															<button id="stopsDownloadButton" class="btn btn-secondary">Download this data as CSV</button>
														</div>
													</div>
													<br><br>
													<div class="card mb-3 card-body bg-light">
														<p>Note: This is a simplified representation of the metro
															stations. <br>In the system-generated data files that you
															will upload in 3rd tab, <br>each platform has its id like
															"MYP1", "MYP2" etc. <br><br>In the final GTFS, "MYP" will be
															automatically set as parent to "MYP1", "MYP2".</p>
													</div>

												</div>
												<div class="col-md-6">

													<div id="map"></div>
												</div>
											</div>
										</div>
										<div class="tab-pane fade" id="Misc" role="tabpanel" aria-labelledby="Misc-tab">
											<h3>3. Misc Info</h3>
											<div class="row">
												<div class="col-md-5">
													<h5>Agency Info <span id="agency-check"></span></h5>
													<div class="form-group row">
														<label for="agency_id" class="col-sm-4 col-form-label">agency_id <red>*</red> :</label>
														<div class="col-sm-8">
															<input required id="agency_id" class="form-control">
														</div>
													</div>
													<div class="form-group row">
														<label for="agency_name" class="col-sm-4 col-form-label">agency_name <red>*
															</red> :</label>
														<div class="col-sm-8">
															<input required id="agency_name" class="form-control">
														</div>
													</div>
													<div class="form-group row">
														<label for="agency_url" class="col-sm-4 col-form-label">agency_url <red>*
															</red> :</label>
														<div class="col-sm-8">
															<input required id="agency_url" class="form-control">
														</div>
													</div>
													<div class="form-group row">
														<label for="agency_timezone" class="col-sm-4 col-form-label">agency_timezone <red>*
															</red> :</label>
														<div class="col-sm-8">
															<input required id="agency_timezone" class="form-control">
														</div>
													</div>
													<h5>Calendar <span id="calendar-check"></span></h5>
													<div class="form-group row">
														<label for="start_date" class="col-sm-4 col-form-label">Start date <red>*</red> :</label>
														<div class="col-sm-8">
															<input required id="start_date" class="form-control" placeholder="YYYYMMDD">
															<small id="end_dateHelpBlock" class="form-text text-muted">
																Date from which the uploaded schedule is in operation, in YYYYMMDD format.
															</small>
														</div>
													</div>
													<div class="form-group row">
														<label for="end_date" class="col-sm-4 col-form-label">End date <red>*</red> :</label>
														<div class="col-sm-8">
															<input required id="end_date" class="form-control" placeholder="YYYYMMDD" value="20990101">
															<small id="end_dateHelpBlock" class="form-text text-muted">
																Needed as a formality. Tentative last date of operation of uploaded schedule, in YYYYMMDD format. Can put any value till 2099. Can change later.
															</small>
														</div>
													</div>
													<hr>
													<h5>Stops Replacement</h5>
													<p>This table is for setting the correct stop_id's for platforms.
														Example: At Ameerpet, Blue Line uses platform 4 and Red Line
														uses platform 2.</p>
													<p>
														<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseReplaceStopTable" aria-expanded="false" aria-controls="collapseReplaceStopTable">
															Show Table
														</button>
													</p>
													<div class="collapse" id="collapseReplaceStopTable">
														<div class="card card-body">
															<div id="replace-stops-table" class="table table-striped"></div>
															<button class="btn btn-primary" id="addReplaceStopButton">Add a Row</button>
														</div>
													</div>
												</div>
												<div class="col-md-7">
													<h5>Fares <span id="fares-check"></span></h5>
													<p>Upload Fares Chart CSV : (<a target="_blank" href="hydcsv_related/fares_chart_pivoted.csv">get
															template</a>)</p>
													<div class="form-group row">
														<label for="fareChart" class="col-sm-4 col-form-label">Fare chart file</label>
														<div class="col-sm-8">
															<input type="file" id="fareChart" class="form-control-file" accept=".csv" name="fareChart">
															<small id="fareChartHelpBlock" class="form-text text-muted">
																Note: This is optional. If no file is chosen, fare_rules file won't be created.
															</small>
														</div>
													</div>
													<br>
													<p>Assign Fare ID's:</p>
													<div class="row">
														<div class="col-md-6">
															<div id="fareIDs-table" class="table table-striped"></div>
														</div>
														<div class="col-md-6" id="fareAddBox">
															<div class="form-group row">
																<label for="fare2add" class="col-sm-4 col-form-label">Add a fare</label>
																<div class="col-sm-6">
																	<input placeholder="ex:50" id="fare2add" type="text" class="form-control">

																</div>
																<div class="col-sm-2">
																	<button class="btn btn-primary" id="fare2addButton" type="button">Add</button>
																</div>
															</div>

															<p class="alert alert-warning"><small>Please ensure that all
																	the fare prices mentioned in the fares chart csv
																	above have been assigned a fare_id here.</small></p>

														</div>
													</div><!-- fares row over -->
													<br>
												</div>

											</div><!-- big row over -->
											<hr>
											<h5>Translations</h5>
											<p>This table will be converted to the <a href="https://developers.google.com/transit/gtfs/reference/gtfs-extensions#translations" target="_blank">translations.txt</a> spec in GTFS extensions, that
												can be used in regions having multiple official languages.</p>
											<p>
												<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseTranslationsTable" aria-expanded="false" aria-controls="collapseTranslationsTable">
													Show Table
												</button>
											</p>
											<div class="collapse" id="collapseTranslationsTable">
												<div class="card card-body">
													<div id="translations-table" class="table table-striped"></div>

													<p><br>
														<button class="btn btn-primary" id="addTranslationButton">Add a Row</button>
														&nbsp;&nbsp;&nbsp;&nbsp;
														<button class="btn btn-warning" id="translationsDownloadButton">Download this data as
															CSV</button>
														<span class="right">Note: names must exactly match those given
															in other places.
														</span>
													</p>
												</div>
											</div>
											<hr>
											<h5>Missing Stops</h5>
											<p>This table will tell the program what timing calculations to apply in
												case a stop is missing from the uploaded csv datafile.</p>
											<p>
												<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseMissingStopsTable" aria-expanded="false" aria-controls="collapseMissingStopsTable">
													Show Table
												</button>
											</p>
											<div class="collapse" id="collapseMissingStopsTable">
												<div class="card card-body">
													<p>There are some default configurations already loaded. Skip this
														if there's been no major changes since last run.</p>
													<div id="missing-stops-table" class="table table-striped"></div>
													<p><br>
														<button class="btn btn-primary btn-sm" id="addMissingStopButton">Add a Row</button>
														&nbsp;&nbsp;&nbsp;&nbsp;
														<button class="btn btn-warning btn-sm" id="missingStopsDownloadButton">Download this data as
															CSV</button>
													</p>
												</div>
											</div>
										</div>
										<div class="tab-pane fade" id="Finally" role="tabpanel" aria-labelledby="Finally-tab">
											<h3>4. Convert to GTFS</h3>

											<div class="row">
												<div class="col">
													<p><button class="btn btn-md btn-warning" id="checkMiscButton" onclick="diagnoseConvertHYD()">&#10148; Diagnose and Convert
															to GTFS</button></p>
													<p id="diagnoseConvertStatus"></p>
													<p id="diagnoseConvertInfo"></p>
												</div>
												<div class="col">
													<div class="alert alert-secondary"><small>
															Note: Pressing the button will first diagnose all the input
															and configuration data. If all is well, it will proceed with
															creating GTFS feed. The process can take a minute or two to
															complete.
															<br><br>
															The import process will be similar to the GTFS import
															process on the home page. The data currently loaded will be
															exported as a backup, and a fresh GTFS feed will be created
															using the data you have uploaded and entered.
															<br><br>
															<a target="_blank" href="hydcsv_related/sample-console-log.txt">Clck
																here</a> to see a sample console log output of a
															successful import.
														</small></div>
												</div>

											</div>
										</div>







									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- END MAIN CONTENT-->
					<!-- END PAGE CONTAINER-->
				</div>

			</div>
		</div>
	</div>


	<!-- Jquery JS-->
	<script src="vendor/jquery-3.2.1.min.js"></script>
	<!-- Bootstrap JS-->
	<script src="vendor/bootstrap-4.1/popper.min.js"></script>
	<script src="vendor/bootstrap-4.1/bootstrap.min.js"></script>

	<!-- Leaflet Maps -->

	<script src="lib/leaflet.js"></script>
	<script src="vendor/leaflet-providers-1.8.0/leaflet-providers.js" type="text/javascript"></script>
	<script src="lib/leaflet-ant-path.js"></script>
	<script src="lib/easy-button.js" alt="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
	<script src="lib/papaparse.min.js" type="text/javascript"></script>
	<script src="lib/L.Control.ZoomBox.min.js" type="text/javascript"></script>

	<!-- Vendor JS       -->
	<script src="vendor/select2/js/select2.min.js"></script>
	<script src="js/Select2EditorTimezone.js"></script>
	<script src="vendor/toast-0.7.1/toast.min.js"></script>
	<script src="vendor/Sortable-1.10.1/Sortable.min.js"></script>
	<!-- Main JS-->
	<script src="js/main.js"></script>
	<script src="js/menu.js"></script>

	<script src="js/commonfuncs.js" type="text/javascript"></script>
	<script src="js/hydcsv.js"></script>

</body>

</html>