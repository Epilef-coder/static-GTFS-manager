<!DOCTYPE html>
<html lang="en">

<head>
	<!-- Required meta tags-->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<title>GTFS Manager : Main info</title>

	<!-- Fontfaces CSS-->
	<link href="css/font-face.css" rel="stylesheet" media="all">
	<link href="vendor/font-awesome-5/css/all.min.css" rel="stylesheet" media="all">

	<!-- Bootstrap CSS-->
	<link href="vendor/bootstrap-4.1/bootstrap.min.css" rel="stylesheet" media="all">

	<!-- Vendor CSS-->

	<link href="vendor/wow/animate.css" rel="stylesheet" media="all">
	<link href="vendor/css-hamburgers/hamburgers.min.css" rel="stylesheet" media="all">
	
	<link href="vendor/select2/css/select2.min.css" rel="stylesheet" media="all">
	<link href="vendor/select2/css/select2-bootstrap4.min.css" rel="stylesheet" media="all">
	<link href="vendor/toast-0.7.1/toast.min.css" rel="stylesheet" media="all">

	<link href="vendor/tabulator-4.4.3/css/bootstrap/tabulator_bootstrap4.min.css" rel="stylesheet" media="all">
	<script src="vendor/tabulator-4.4.3/js/tabulator.min.js"></script>
	<!-- Main CSS-->
	<link href="css/theme.css" rel="stylesheet" media="all">
	<!-- Put the CSSs first and JSs next -->
	<script src="config/settings.js" type="text/javascript"></script>
	<style>
	#mapId {
		height:400px;
	}
	</style>
</head>

<body class="page-content--bgf7">
	<div class="page-wrapper">
		<!-- HEADER DESKTOP-->
		<header class="header-desktop3 d-none d-lg-block">
			<div class="section__content section__content--p35">
				<div class="header3-wrap">
					<div class="header__logo">
						<a href="#">
							<img src="extra_files/GTFS.png" width="52" height="170" alt="GTFS Manager" />
						</a>
					</div>
					<div class="header__navbar" id="navmenuinsert">
						<!-- menu will be inserted from menu.js.-->
					</div>
					<div class="form-inline my-2 my-md-0">
						<input id="password" class="form-control mr-sm-2" type="text" placeholder="pw for edits" style="width:200px;" id="password">
					</div>
				</div>
			</div>
		</header>
		<!-- END HEADER DESKTOP-->
		<!-- MAIN CONTENT-->
		<div class="page-content--bgf7">
			<div class="section__content section__content--p30">
				<div class="container-fluid p-t-20">
					<div class="row">
						<div class="col-md-12">
							<div class="accordion" id="accordionExample">
								<div class="card">
									<div class="card-header" id="headingOne">
										<h2 class="mb-0">
											<button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
												<i class="fas fa-angle-right"></i> Instructions
											</button>
										</h2>
									</div>
									<div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
										<div class="card-body">
											<b>Trips tab</b>
											<ul>
												<li>Pick a Route from the dropdown. In some time, all the trips under this route will load.</li>
												<li>In case it's a new route, the table will be empty.</li>
												<li>If the chosen route's default sequence has been saved to the DB in the Routes page Sequence tab, then a "Create new trip" box will be visible below the table.</li>
												<li>You can create a new trip by filling in or selecting the fields provided : Calendar service, start time, direction.</li>
												<li>On clicking "Add a Trip", new entry will be created in the Trips table.</li>
												<li>Many columns will be populated based on your selection, but you can change the values (other than route and trip ids) by clicking on the respective cells.</li>
												<li>If you have set default shapes for this route in Routes page, then below the table on the right you will have options to assign these shapes to all the trips under the chosen route, repsectively by direction.</li>
												<li><b>block_id</b> field is for the vehicle indentifier.</li>
												<li>To access a trip's timings, select a trip (click on left side handle) and move to Timings tab.</li>
												<li>After making changes, be sure to click the big green button at the bottom to commit your changes to the DB.</li>
											</ul>
											<b>Stop_times tab</b>
											<ul>
												<li>The trip you have chosen will be displayed in green. Click the "load timings" button.</li>
												<li>In some seconds the timings should load in the table</li>
												<li>You can edit some columns like arrival_time and departure_time, and other columns on left side are fixed.</li>
												<li>After making changes, be sure to click the big green button at the bottom to commit your changes to the DB.</li>
											</ul>
											<p>Read the <a href="https://developers.google.com/transit/gtfs/reference/#tripstxt">trips reference</a> docs for learning more about trips, and read the <a href="https://developers.google.com/transit/gtfs/reference/#stop_timestxt">stop_times reference</a> for learning more about the way the timings data is stored in GTFS.</p>
											<p>Note: Arrival time and departure time must be specified for the first and the last stop in a trip; rest may be left blank. (if so, set timepoint to 0-Estimated ).

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col-md-12">
							<div class="card">
								<div class="card-header">
									<strong class="card-title mb-3">Trips and Timings (Stop_times)</strong>
								</div>
								<div class="card-body">
									<ul class="nav nav-tabs" id="myTab" role="tablist">
										<li class="nav-item">
											<a class="nav-link active" id="trips-tab" data-toggle="tab" href="#trips" role="tab" aria-controls="trips" aria-selected="true">Trips</a>
										</li>
										<li class="nav-item">
											<a class="nav-link" id="stoptimes-tab" data-toggle="tab" href="#stoptimes" role="tab" aria-controls="stoptimes" aria-selected="false">Stop times</a>
										</li>
									</ul>
									<div class="tab-content pl-3 p-1" id="myTabContent">
										<div class="tab-pane fade show active" id="trips" role="tabpanel" aria-labelledby="trips-tab">
											<div class="form-group row">
												<label for="routeSelect" class="col-sm-2 col-form-label"><b>Pick a route</b></label>
												<div class="col-sm-10">
													<select id="routeSelect" class="form-control">
														<option></option>
													</select>
												</div>
											</div>
											<h5>Trips</h5>
											<div id="trips-table"></div>
											<div id="newTripHTML">
												<div class="row">
													<div class="col">
														<div id="Form-AddCalander" data-parsley-validate>
															<p>This route's <a href="sequence.html">default sequence</a> has been set, so you can <b>Create a new trip:</b></p>
															<div class="form-group row">
																<label for="trip_calendar" class="col-sm-2 col-form-label">Calendar service</label>
																<div class="col-sm-10">
																	<select id="trip_calendar" class="form-control" required autocomplete="off" data-parsley-required-message="You have to select a service, without it it won't work!"></select>
																</div>
															</div>
															<div class="form-group row">
																<label for="trip_time" class="col-sm-2 col-form-label">Start time</label>
																<div class="col-sm-10">
																	<input id="trip_time" type="time" name="time" class="form-control" required autocomplete="off" data-parsley-required-message="The program will calculate time and duration based on this.">
																</div>
															</div>
															<div class="form-group row">
																<label for="trip_direction" class="col-sm-2 col-form-label">Direction</label>
																<div class="col-sm-10">
																	<select id="trip_direction" class="form-control" required autocomplete="off" data-parsley-required-message="You have to select a direction.">
																		<option value="0" selected="selected">Onward</option>
																		<option value="1">Return</option>
																		<option value="none">None</option>
																		<option value="both">Both</option>
																	</select>
																</div>
															</div>
															<div class="form-group row">
																<div class="col-sm-10">
																	<button class="btn btn-primary" id="addTripButton" type="button">Add a Trip</button></p>
																</div>
															</div>
														</div>
													</div>
													<div class="col">
														<div id="shapeApplyHTML" style="display:none" class="alert alert-warning">
															<p>This route has default shape(s) set:
																<br><span id="defaultShapesInfo"></span>
																<br>Would you like to apply them to all the trips?
																<br><button class="btn btn-outline-info" id="defaultShapesApplyButton">Apply shapes to all trips</button>
															</p>
															<p id="defaultShapesApplyStatus"></p>
														</div>
													</div>
												</div>


											</div>											
											<p><span id="tripsSaveStatus"></span></p>


											<small>
												To delete a trip you have just added, just reload this page without saving changes.
												<br>
												To delete an existing trip that has already been saved in the db, please go to the <a href="misc.html">Miscellaneous page</a>, Maintenance tab.

											</small>
										</div>
										<div class="tab-pane fade" id="stoptimes" role="tabpanel" aria-labelledby="stoptimes-tab">
											<h5>Stop_times (timings)</h5>
											<div class="form-row">
												<div class="col">
													<div class="input-group mb-2">
														<div class="input-group-prepend">
															<div class="input-group-text">Route</div>
														</div>
														<input type="text" class="form-control" id="StopTimesRoute" disabled>
													</div>
												</div>
												<div class="col">
													<div class="input-group mb-2">
														<div class="input-group-prepend">
															<div class="input-group-text">Trip</div>
														</div>
														<input type="text" class="form-control" id="StopTimesTrip" disabled>
													</div>
												</div>
												<div class="col">
													<div class="input-group mb-2">
														<div class="input-group-prepend">
															<div class="input-group-text">Direction</div>
														</div>
														<input type="text" class="form-control" id="StopTimesDirection" disabled>
													</div>
												</div>
											</div>

											<div id="stop-times-table"></div>
											<br>
											<!-- <p>If you edit any of the timings, make sure to <button id="saveTimings" class="btn btn-normal" disabled>Save Timings to DB</button> before changing to another trip above.</p>-->
											<p class="alert alert-warning">Note: To change the default stops sequence for new trips, please go to <a href="sequence.html">Default Route Sequence</a> page and change the sequence from there.</p>


										</div>
									</div>

								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- END MAIN CONTENT-->
			<!-- END PAGE CONTAINER-->
		</div>

	</div>
	<!-- Modal -->
	<div class="modal fade" id="DeleteColumnModal" tabindex="-1" role="dialog" aria-labelledby="DeleteColumnModalTitle" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="DeleteColumnModalTitle">Delete Non standard columns</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body" id="DeleteColumnModalBody">
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary nonstandardbutton" id="DeleteColumnButton">Remove columns</button>
					<button type="button" class="btn btn-primary nonstandardbutton" id="CopySelectedRowButton">Copy selected trip</button>
				</div>
			</div>
		</div>
	</div>
	<!-- The Modals -->
	<div class="modal" tabindex="-1" role="dialog" id="CreateStopTimesModal" aria-labelledby="CreateStopTimesTitle" aria-hidden="true">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="CreateStopTimesTitle">Create stop_times based on:</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div class="container-fluid">
						<div class="row">
							<div class="col-md-12">
								<p>For the creation of the new stop_times data you can use the following sources:</p>
							</div>
						</div>
						<div class="row">
							<div class="col-md-12" id="StoptimesSources">
								
							</div>
						</div>						
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>					
					<button id="CreateNewStopTimesButton" class="btn btn-primary">Use the selected source</button>
				</div>
			</div>
		</div>
	</div>
	<!-- End The Modal -->
	<div class="modal" id="mapModal" tabindex="-1" role="dialog" aria-labelledby="mapModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="mapModalLabel">Preview of the trip</h5>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
				</div>
				<div class="modal-body">
					<div id="mapId" style="height: 400px;"></div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>	
				</div>
			</div>
		</div>
	</div>
	<!-- Jquery JS-->
	<script src="vendor/jquery-3.2.1.min.js"></script>
	<!-- Bootstrap JS-->
	<script src="vendor/bootstrap-4.1/popper.min.js"></script>
	<script src="vendor/bootstrap-4.1/bootstrap.min.js"></script>
	<!-- Leaflet Maps -->
    <script src="lib/leaflet.js"></script>
    <script src="vendor/leaflet-providers-1.8.0/leaflet-providers.js" type="text/javascript"></script>
	<!-- Vendor JS       -->
	<script src="vendor/slick/slick.min.js"></script>
	<script src="vendor/wow/wow.min.js"></script>

	<script src="vendor/bootstrap-progressbar/bootstrap-progressbar.min.js"></script>
	
	
	<script src="vendor/select2/js/select2.min.js"></script>
	<script src="vendor/toast-0.7.1/toast.min.js"></script>
	<script src="vendor/moment-2.24.0/moment.js"></script>
	<script src="js/tabulator-footer.js"></script>
	 <!-- Form validator-->
	 <script src="vendor/parsley-2.9.1/parsley.min.js"></script>
	<!-- Main JS-->
	<script src="js/main.js"></script>
	<script src="js/menu.js"></script>



	<script src="js/commonfuncs.js" type="text/javascript"></script>
	<script src="js/tripstimings.js"></script>

</body>

</html>